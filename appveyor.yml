image: Visual Studio 2017
configuration: Release

install:
  ## Download nasm
  - mkdir nasm
  - cd nasm
  - appveyor DownloadFile https://www.nasm.us/pub/nasm/releasebuilds/2.14.02/win64/nasm-2.14.02-win64.zip -FileName nasm.zip
  - 7z e -y nasm.zip
  - set PATH=%PATH%;%CD%
  ## Prepare cmake
  - cd %APPVEYOR_BUILD_FOLDER%
  - mkdir cmake_build
  - cd cmake_build
  - cmake --version

before_build:
  - cmake c:\projects\mozjpeg

build_script: msbuild "C:\projects\mozjpeg\cmake_build\mozjpeg.sln"

artifacts:
 - path: cmake_build\**\Release\**\mozjpeg*.exe
 - path: cmake_build\**\Release\**\mozjpeg*.lib
